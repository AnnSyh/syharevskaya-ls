(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{104:function(e,t,r){"use strict";var i=r(389);r.d(t,"a",(function(){return i.a}))},156:function(e,t,r){"use strict";var i=r(388);r.d(t,"a",(function(){return i.a}))},392:function(e,t,r){},394:function(e,t,r){},395:function(e,t,r){},409:function(e,t,r){"use strict";r(392)},411:function(e,t,r){"use strict";r(394)},412:function(e,t,r){"use strict";r(395)},413:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"works-page-component container wrapper--white"},[r("div",{staticClass:"page-content"},[r("div",{staticClass:"container"},[r("div",{staticClass:"header  page-header"},[r("h1",{staticClass:"header__title page-title"},[e._v('Блок "'+e._s(this.$route.meta.name)+'"')])]),e._v(" "),r("div",{staticClass:"form-component"},[r("ul",{staticClass:"works-cards"},[e.emptyCardIsShown?r("li",{staticClass:"li-form"},[r("form-review",{staticClass:"form",attrs:{currentReview:e.currentReview},on:{close:e.closeHandler,click:e.handleClick}})],1):r("li",{staticClass:"empty-work"},[0==e.emptyCardIsShown?r("square-btn",{attrs:{type:"square",title:"Добавить отзыв"},on:{click:function(t){e.emptyCardIsShown=!0}}}):e._e()],1),e._v(" "),e._l(e.reviews,(function(t){return r("li",{key:t.id,staticClass:"item",attrs:{emptyCardIsShown:e.emptyCardIsShown}},[r("review-card",{attrs:{review:t},on:{edit:e.editHandler}})],1)}))],2)])])])])};i._withStripped=!0;var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("form",{staticClass:"form",on:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[r("card",[r("h1",{attrs:{slot:"title"},slot:"title"},[e._v("Добавить отзыв")]),e._v(" "),r("div",{staticClass:"form-container",attrs:{slot:"content"},slot:"content"},[r("div",{staticClass:"form-cols"},[r("div",{staticClass:"w-30p"},[r("div",{staticClass:"label-block"},[r("label",{class:["uploader",{active:e.newReview.preview},{hovered:e.hovered}],style:{backgroundImage:"url("+e.newReview.preview+")"},attrs:{"error-message":e.validation.firstError("newReview.preview")},on:{dragover:e.handleDragOver,dragleave:function(t){e.hovered=!1},drop:e.handleChange}},[r("app-input",{staticClass:"input-hidden",attrs:{"error-message":e.validation.firstError("newReview.preview")},model:{value:e.newReview.preview,callback:function(t){e.$set(e.newReview,"preview",t)},expression:"newReview.preview"}}),e._v(" "),r("div",{staticClass:"uploader-title"},[e._v("Перетащите или загрузите картинку")]),e._v(" "),r("div",{staticClass:"uploader-link"})],1),e._v(" "),r("app-button",{attrs:{plain:"",typeAttr:"file"},on:{change:e.handleChange}})],1)]),e._v(" "),r("div",{staticClass:"w-70p"},[r("div",{staticClass:"form-cols"},[r("div",{staticClass:"form-col"},[r("app-input",{attrs:{"error-message":e.validation.firstError("newReview.author"),title:"Имя автора"},model:{value:e.newReview.author,callback:function(t){e.$set(e.newReview,"author",t)},expression:"newReview.author"}})],1),e._v(" "),r("div",{staticClass:"form-col"},[r("app-input",{attrs:{"error-message":e.validation.firstError("newReview.occ"),title:"Титул автора"},model:{value:e.newReview.occ,callback:function(t){e.$set(e.newReview,"occ",t)},expression:"newReview.occ"}})],1)]),e._v(" "),r("div",{staticClass:"form-row"},[r("app-input",{attrs:{"error-message":e.validation.firstError("newReview.text"),"field-type":"textarea",title:"Отзыв"},model:{value:e.newReview.text,callback:function(t){e.$set(e.newReview,"text",t)},expression:"newReview.text"}})],1),e._v(" "),r("div",{staticClass:"form-btns"},[r("div",{staticClass:"btn"},[r("app-button",{attrs:{plain:"",title:"Отмена",typeAttrs:"button"},on:{click:function(t){return e.$emit("close",t)}}})],1),e._v(" "),r("div",{staticClass:"btn"},[r("app-button",{attrs:{title:"Сохранить",disabled:e.isSubmitDisabled}})],1)])])])])])],1)};n._withStripped=!0;var o=r(104),a=r(155),s=r(103),c=r(59),u=r(47);function l(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var d={components:{card:o.a,Input:a.a,appButton:s.a,appInput:a.a,Validator:c.Validator},mixins:[c.mixin],validators:{"newReview.author":function(e){return c.Validator.value(e).required("Введите имя")},"newReview.text":function(e){return c.Validator.value(e).required("Введите описание")},"newReview.occ":function(e){return c.Validator.value(e).required("Введите титул")},"newReview.preview":function(e){return c.Validator.value(e).required("Загрузите картинку")}},data:function(){return{hovered:!1,newReview:w({},this.currentReview),isSubmitDisabled:!1}},props:{currentReview:{type:Object,default:function(){return{}}}},computed:w({},Object(u.d)("reviews",{reviews:function(e){return e.data}})),methods:w(w({},Object(u.b)({showTooltip:"tooltips/show",addNewReview:"reviews/add",updateNewReview:"reviews/update"})),{},{setReview:function(){this.currentReview?this.newReview=w({},this.currentReview):this.newReview={id:null,author:"",occ:"",text:"",photo:{},preview:""}},handleDragOver:function(e){e.preventDefault(),this.hovered=!0},handleSubmit:function(e){var t,r=this;return(t=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.$validate();case 2:if(e.t0=e.sent,!1!==e.t0){e.next=5;break}return e.abrupt("return");case 5:if(!r.newReview.id){e.next=14;break}return e.next=8,r.updateNewReview(r.newReview);case 8:return e.next=10,r.updateNewReview(r.newReview);case 10:1==e.sent&&(r.showTooltip({text:"Успешное редактирование отзыва",type:"success"}),r.$emit("close")),e.next=18;break;case 14:return e.next=16,r.addNewReview(r.newReview);case 16:r.showTooltip({text:"Успешное создание нового отзыва",type:"success"}),r.$emit("close");case 18:case"end":return e.stop()}}),e,this)})),function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function a(e){l(o,i,n,a,s,"next",e)}function s(e){l(o,i,n,a,s,"throw",e)}a(void 0)}))})()},handleChange:function(e){e.preventDefault();var t=e.dataTransfer?e.dataTransfer.files[0]:e.target.files[0];this.newReview.photo=t,this.renderPhoto(t),this.hovered=!1},renderPhoto:function(e){var t=this,r=new FileReader;r.readAsDataURL(e),r.onloadend=function(){t.newReview.preview=r.result},r.onerror=function(){t.showTooltip({text:"произошла ошибка",type:"error"})},r.onabort=function(){t.showTooltip({text:"произошла ошибка",type:"error"})}}}),created:function(){this.setReview()},watch:{currentReview:function(){this.setReview()}}},f=(r(409),r(10)),h=Object(f.a)(d,n,[],!1,null,"41d4728f",null);h.options.__file="src/admin/components/formReview/formReview.vue";var b=h.exports,m=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("card",{attrs:{simple:""}},[r("div",{staticClass:"header"},[r("user",{attrs:{title:e.review.author,subtitle:e.review.occ,src:e.cover}})],1),e._v(" "),r("div",{staticClass:"content"},[r("div",{staticClass:"text text-review"},[r("p",[e._v(e._s(e.review.text))])]),e._v(" "),r("div",{staticClass:"bottom-line"},[r("icon",{attrs:{symbol:"pencil",title:"Править"},on:{click:function(t){return e.edit()}}}),e._v(" "),r("icon",{attrs:{symbol:"cross",title:"Удалить"},on:{click:e.removeReview}})],1)])])};m._withStripped=!0;var R=r(156),y=r(154);function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var j={components:{card:o.a,icon:R.a,user:y.a},props:{review:{type:Object,default:function(){return{}}},emptyCardIsShown:{type:Boolean}},data:function(){return{currentReview:{id:"",author:"",occ:"",text:"",preview:""}}},computed:{cover:function(){return"https://webdev-api.loftschool.com/".concat(this.review.photo)}},methods:C(C({},Object(u.b)({showTooltip:"tooltips/show",removeReviewAction:"reviews/remove",createReviewAction:"reviews/create",updateReviewAction:"reviews/update"})),{},{edit:function(){this.setReview(),this.$emit("edit",this.currentReview)},setReview:function(){this.currentReview={id:this.review.id,author:this.review.author,occ:this.review.occ,text:this.review.text,preview:"https://webdev-api.loftschool.com/".concat(this.review.photo)}},removeReview:function(){this.review?(this.removeReviewAction(this.review.id),this.showTooltip({text:"Успешное удаление отзыва",type:"error"})):this.$emit("remove")}}),created:function(){this.setReview()}},_=(r(411),Object(f.a)(j,m,[],!1,null,"7b932b0f",null));function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){k(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function k(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}_.options.__file="src/admin/components/reviewCard/reviewCard.vue";var S={components:{formReview:b,reviewCard:_.exports,card:o.a,icon:R.a,iconedBtn:s.a,squareBtn:s.a},data:function(){return{emptyCardIsShown:!1,currentReview:null}},computed:P({},Object(u.d)("reviews",{reviews:function(e){return e.data}})),methods:P(P({},Object(u.b)({fetchReviews:"reviews/fetch"})),{},{handleClick:function(){1==this.reviews.status&&(this.emptyCardIsShown=!1)},editHandler:function(e){this.currentReview=P({},e),this.emptyCardIsShown=!0},closeHandler:function(){this.emptyCardIsShown=!1}}),watch:{emptyCardIsShown:function(){this.emptyCardIsShown||(this.currentReview=null)}},mounted:function(){this.fetchReviews()},created:function(){this.fetchReviews()}},D=(r(412),Object(f.a)(S,i,[],!1,null,"f7691830",null));D.options.__file="src/admin/pages/review/reviews.vue";t.default=D.exports}}]);